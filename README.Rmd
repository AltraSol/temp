---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
options(tibble.print_min = 5, tibble.print_max = 5)
```

# vary <a href='https://github.com/ulchc/vary'><img src='man/figures/logo.png' align="right" height="139" /></a>
<!-- badges: start -->
[![R-CMD-check](https://github.com/ulchc/vary/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/ulchc/vary/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

## Overview
Methods to reliably structure data when the source format or load point is expected to vary over time; or when inputs lack structure completely and are not immediately compatible with typical data manipulation packages. For situations where connection points are pdfs or user-edited Excel sheets, and table dimensions and naming conventions need to be dynamically set using pattern recognition. 

## Motivation
To enhance code readability and increase the resilience of data pipelines between uncommon sources and standardized reports. In keeping with the report oriented end result, a few methods included in this package are aimed at preparing data for export.

## Installation

```{r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("ulchc/vary")
```

## Usage

After installation from GitHub, you can load it with:
```{r}
library(vary)
```

```{r, include=FALSE}
library(tidyr)
library(dplyr)

set.seed(1)
mismatched <- tidyr::table2
n_rows <- sample(nrow(mismatched), 5)
mismatched[n_rows, 1] <- table2[n_rows, 3]
mismatched[n_rows, 3] <- table2[n_rows, 1]
```

```{r, echo=FALSE}
message("An example of data with mismatched columns: 'country' <-> 'type'")
mismatched
```

```{r}
row_index <-
  which_rows(
    mismatched,
    contain_strings = c("CASES", "2000"),
    all_strings = TRUE,
    case_sensitive = FALSE,
    flatten = TRUE
  )
```
```{r}
mismatched[row_index, ]
```
Using row_index, 3 rows returned for cases in 2000
```{r}
mismatched %>% filter(type == "cases" & year == 2000)
```
Using filter, 2 rows returned & 1 missed due to column misalignment

## R Documentation

#### Use ?vary to view a linked list of the documentation

Structure Data
```{r, eval=FALSE}
?which_rows()
?flatten_page_list()
?drop_na_rows()
?drop_na_cols()
```
Locate Files
```{r, eval=FALSE}
?get_downloads_folder()
?files_matching()
```
Other (possible future relocation)
```{r, eval=FALSE}
?clean_cols_in()
?clean_cols_out()
?`%notin%`
```

